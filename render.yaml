services:
  - type: web
    name: n8n
    runtime: image
    plan: free  # Upgrade to 'starter' (~$5/mo) for no spin-down
    image:
      url: docker.io/n8nio/n8n:latest
    envVars:
      - key: DB_TYPE
        value: postgresdb
      - key: DB_POSTGRESDB_DATABASE
        value: postgres
      - key: DB_POSTGRESDB_HOST
        value: aws-1-ap-southeast-1.pooler.supabase.com  # Your Supabase pooler host
      - key: DB_POSTGRESDB_PORT
        value: 5432  # Session mode
      - key: DB_POSTGRESDB_USER
        value: postgres.gcwamhqsmlawiunekgsq  # Copy exactly from your Supabase dashboard
      - key: DB_POSTGRESDB_PASSWORD
        value: Dalandan012345**  # Replace with your actual Supabase password
      - key: DB_POSTGRESDB_SCHEMA
        value: public
      - key: DB_POSTGRESDB_SSLMODE
        value: require
      - key: DB_POSTGRESDB_CONNECTION_TIMEOUT
        value: 60000  # 60s for reliability
      - key: WEBHOOK_URL
        value: https://your-render-service.onrender.com/  # Set after deploy (leave as is for now)
      - key: N8N_BASIC_AUTH_ACTIVE
        value: true  # For security
      - key: N8N_BASIC_AUTH_USER
        value: realjohnzeljeric.berania@gmail.com  # Change if you want
      - key: N8N_BASIC_AUTH_PASSWORD
        value: Dalandan012345**  # Pick a strong one
